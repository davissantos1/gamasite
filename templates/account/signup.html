<!DOCTYPE html>
<html>
  {% load static %} 
  {% include '_head.html' %}
  <body>
    {% include '_header.html' %}
    <div class="container form-container signup-page">
      <div class="row justify-content-center align-items-center ">
        <div class="col-md-8">
          <h2 class="text-center mb-4">Cadastro</h2>
          <form method="post" action="{% url 'account_signup' %}" id="signup-form">
            {% csrf_token %} 
            <div class="row">
              <div class="col-md-6">
                <div class="form-group">
                  <label for="id_first_name">Nome</label>
                  {{ form.first_name }}
                </div>
                <div class="form-group">
                  <label for="id_last_name">Sobrenome</label>
                  {{ form.last_name }}
                </div>
                <div class="form-group">
                  <label for="id_email">E-mail</label>
                  {{ form.email }}
                </div>
                <div class="form-group">
                  <label for="id_cpf_cnpj">CPF/CNPJ</label>
                  {{ form.cpf_cnpj }}
                </div>
                <div class="form-group">
                  <label for="id_cep">CEP</label>
                  {{ form.cep }}
                </div>
                <div class="form-group">
                  <label for="id_logradouro">Logradouro</label>
                  {{ form.logradouro }}
                </div>
                <div class="form-group">
                  <label for="id_numero">Número</label>
                  {{ form.numero }}
                </div>
              </div>
              <div class="col-md-6">
                <div class="form-group">
                  <label for="id_complemento">Complemento</label>
                  {{ form.complemento }}
                </div>
                <div class="form-group">
                  <label for="id_bairro">Bairro</label>
                  {{ form.bairro }}
                </div>
                <div class="form-group">
                  <label for="id_cidade">Cidade</label>
                  {{ form.cidade }}
                </div>
                <div class="form-group">
                  <label for="id_estado">Estado</label>
                  {{ form.estado }}
                </div>
                <div class="form-group">
                  <label for="id_pais">País</label>
                  {{ form.pais }}
                </div>
                <div class="form-group">
                  <label for="id_telefone_comercial">Telefone Comercial</label>
                  {{ form.telefone_comercial }}
                </div>
                <div class="form-group">
                  <label for="id_telefone_celular">Telefone Celular</label>
                  {{ form.telefone_celular }}
                </div>
              </div>
            </div>
            <button type="submit" class="btn btn-secondary btn-block mt-4">Cadastrar</button>
          </form>
        </div>
      </div>
    </div>
    {% include '_footer.html' %}
    <script>
      document.getElementById('id_cep').addEventListener('blur', function() {
        var cep = this.value.replace(/\D/g, '');
        if (cep) {
          var script = document.createElement('script');
          script.src = 'https://viacep.com.br/ws/' + cep + '/json/?callback=preencherEndereco';
          document.body.appendChild(script);
        }
      });

      function preencherEndereco(conteudo) {
        if (!('erro' in conteudo)) {
          document.getElementById('id_logradouro').value = conteudo.logradouro;
          document.getElementById('id_bairro').value = conteudo.bairro;
          document.getElementById('id_cidade').value = conteudo.localidade;
          document.getElementById('id_estado').value = conteudo.uf;
        } else {
          alert('CEP não encontrado.');
        }
      }
    </script>
  </body>
</html>